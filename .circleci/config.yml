version: 2
jobs:
  build:
    working_directory: ~/repo
    docker:
      - image: circleci/node:dubnium  # primary container for the build job
    steps:
      - checkout
      - run:
          name: "Update NPM"
          command: |
            sudo npm install -g npm@latest
      - run:
          name: "Resolve Dependencies"
          command: |
            npm install
      - run:
          name: "Run Nightwatch Webdriver"
          command: |
            cd nightwatch/webdriver/examples/update-sauce
            npm install
            npm run test.saucelabs.us
      - run:
          name: "Run Protractor Best Practices"
          command: |
            cd protractor/selenium/best-practices
            npm install
            npm run test.saucelabs.us
      - run:
          name: "Run TestCafe Best Practices"
          command: |
            cd testcafe/best-practices
            npm install
            npm run test.saucelabs.us
      - run:
          name: "Run WebdriverIO Headless"
          command: |
            cd webdriverio/webdriver/examples/headless
            npm install
            npm run test.saucelabs.headless
      - run:
          name: "Run WebdriverIO Best Practices"
          command: |
            cd webdriverio/webdriver/best-practices
            npm install
            npm run test.saucelabs.us -- --maxInstances=25
